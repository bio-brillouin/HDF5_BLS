

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>The HDF5_BLS package &mdash; HDF5_BLS v1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=b86133f3" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=e59714d7" />

  
    <link rel="shortcut icon" href="../_static/myicon.svg"/>
      <script src="../_static/jquery.js?v=5d32c60e"></script>
      <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../_static/documentation_options.js?v=76e2d817"></script>
      <script src="../_static/doctools.js?v=9bcbadda"></script>
      <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="HDF5_BLS.wrapper" href="../_autosummary/HDF5_BLS.wrapper.html" />
    <link rel="prev" title="The file format" href="file_format.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            HDF5_BLS
              <img src="../_static/myicon.svg" class="logo" alt="Logo"/>
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quickstart.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="file_format.html">The file format</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The HDF5_BLS package</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#installation-and-presentation">Installation and presentation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installation">Installation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#presentation">Presentation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#module-structure">Module structure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#the-wrapper-object">The Wrapper object</a></li>
<li class="toctree-l2"><a class="reference internal" href="#adding-data-to-the-hdf5-file-from-script">Adding data to the HDF5 file (from script)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#general-approach-to-adding-data-to-the-hdf5-file">General approach to adding data to the HDF5 file</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exception-1-adding-treated-data">Exception 1: Adding treated data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exception-2-adding-an-abscissa">Exception 2: Adding an abscissa</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#importing-data-from-external-files">Importing data from external files</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#general-approach-for-importing-data">General approach for importing data</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#adding-and-merging-hdf5-files">Adding and merging HDF5 files</a></li>
</ul>
</li>
</ul>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/HDF5_BLS.wrapper.html">HDF5_BLS.wrapper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/HDF5_BLS.analyze.html">HDF5_BLS.analyze</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/HDF5_BLS.treat.html">HDF5_BLS.treat</a></li>
<li class="toctree-l1"><a class="reference internal" href="../_autosummary/HDF5_BLS.load_data.html">HDF5_BLS.load_data</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">HDF5_BLS</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">The HDF5_BLS package</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/source/hdf5_bls_package.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="the-hdf5-bls-package">
<h1>The HDF5_BLS package<a class="headerlink" href="#the-hdf5-bls-package" title="Link to this heading"></a></h1>
<section id="installation-and-presentation">
<h2>Installation and presentation<a class="headerlink" href="#installation-and-presentation" title="Link to this heading"></a></h2>
<section id="installation">
<h3>Installation<a class="headerlink" href="#installation" title="Link to this heading"></a></h3>
<p>To install the package, you can either download the source code from the GitHub repository or use pip to install the package. We recommend using pip for users who do not intend on working on the package as it is the easiest way to install the package.</p>
<p><strong>Using pip</strong></p>
<p>To install the package using pip, run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>pip<span class="w"> </span>install<span class="w"> </span>HDF5_BLS
</pre></div>
</div>
<p><strong>Downloading the source code</strong></p>
<p>The source code can be downloaded from the ‘GitHub repository &lt;<a class="reference external" href="https://github.com/bio-brillouin/HDF5_BLS">https://github.com/bio-brillouin/HDF5_BLS</a>&gt;’__. To download the source code, click on the green button “Code” and then click on the “Download ZIP” button. Once the download is complete, unzip the file and open a terminal in the folder where the code is stored. To install the package, run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>setup.py<span class="w"> </span>install
</pre></div>
</div>
<p>This will install the package and all its dependencies. To check if the package was installed correctly, run the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>-c<span class="w"> </span><span class="s2">&quot;import HDF5_BLS&quot;</span>
</pre></div>
</div>
<p>If the package was installed correctly, the command will not return any error.</p>
</section>
<section id="presentation">
<h3>Presentation<a class="headerlink" href="#presentation" title="Link to this heading"></a></h3>
<p>The HDF5_BLS library is a Python package meant to interface Python code with a HDF5 file.</p>
<p>The goal of this package is to allow the user to semalessly integrate the proposed standard to their existing code. A detailed description of the package will be given in the later sections of this tutorial. Here is however a quick code example to show the integration of the package in a simple case:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1">###############################################################################</span>
<span class="c1"># Existing imports</span>
<span class="c1">###############################################################################</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">HDF5_BLS</span><span class="w"> </span><span class="kn">import</span> <span class="n">wrapper</span>

<span class="c1"># Create a new file</span>
<span class="n">wrp</span> <span class="o">=</span> <span class="n">wrapper</span><span class="o">.</span><span class="n">Wrapper</span><span class="p">(</span><span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;path/to/the/file.h5&quot;</span><span class="p">)</span>

<span class="c1">###############################################################################</span>
<span class="c1"># Existing code extracting data from a file</span>
<span class="c1">###############################################################################</span>

<span class="c1"># Store the data in the file</span>
<span class="n">wrp</span><span class="o">.</span><span class="n">add_raw_data</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span> <span class="n">parent_group</span> <span class="o">=</span> <span class="s2">&quot;Brillouin/path/in/the/file&quot;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Name of the dataset&quot;</span><span class="p">)</span>

<span class="c1">###############################################################################</span>
<span class="c1"># Existing code extracting a PSD and a frequency vector from the data</span>
<span class="c1">###############################################################################</span>

<span class="c1"># Store the frequency vector together with the raw data</span>
<span class="n">wrp</span><span class="o">.</span><span class="n">add_frequency</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">frequnecy</span><span class="p">,</span> <span class="n">parent_group</span> <span class="o">=</span> <span class="s2">&quot;Brillouin/path/in/the/file&quot;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Frequency vector&quot;</span><span class="p">)</span>

<span class="c1"># Store the PSD dataset together with the raw data</span>
<span class="n">wrp</span><span class="o">.</span><span class="n">add_PSD</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">PSD</span><span class="p">,</span> <span class="n">parent_group</span> <span class="o">=</span> <span class="s2">&quot;Brillouin/path/in/the/file&quot;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;PSD&quot;</span><span class="p">)</span>

<span class="c1">###############################################################################</span>
<span class="c1"># Existing code extracting the shift and linewidth of the data</span>
<span class="c1">###############################################################################</span>

<span class="c1"># Store the PSD dataset together with the raw data</span>
<span class="n">wrp</span><span class="o">.</span><span class="n">add_treated_data</span><span class="p">(</span><span class="n">shift</span> <span class="o">=</span> <span class="n">shift</span><span class="p">,</span> <span class="n">linewidth</span> <span class="o">=</span> <span class="n">linewidth</span><span class="p">,</span> <span class="n">parent_group</span> <span class="o">=</span> <span class="s2">&quot;Brillouin/path/in/the/file&quot;</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;PSD&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This package also aims at unifying both the way to extract PSD from raw data and extract Brillouin shift and linewidth from the PSD. We will describe later how to do this, we encourage interested readers to already try and add the above code to their code and see how it works.</p>
</section>
<section id="module-structure">
<h3>Module structure<a class="headerlink" href="#module-structure" title="Link to this heading"></a></h3>
<p>The HDF5_BLS package is built around the following different modules:</p>
<ul class="simple">
<li><p><em>wrapper</em>: This module is used to interact with HDF5 files. It is used to read the data, to write the data and to modify any aspect of the HDF5 file (dataset, groups or attributes).</p></li>
<li><p><em>analyze</em>: This module is used to convert raw data taken from a spectrometer into a physically meaningful Power Spectral Density (PSD) array. This process is done to be reliable</p></li>
<li><p><em>treat</em>: This module is used to extract information from the PSD array, such as the frequency shift and line width of the spectral lines.</p></li>
<li><p><em>load_data</em>: This module is used to import data from any formats of interest. This module is an interface between physical files stored on the PC and the wrapper module. It has been designed to be easily extended to any format of data.</p></li>
</ul>
</section>
</section>
<section id="the-wrapper-object">
<h2>The Wrapper object<a class="headerlink" href="#the-wrapper-object" title="Link to this heading"></a></h2>
<p>The “wrapper” module has one main object: <em>Wrapper</em>. This object is used to interact with the HDF5 file. It is used to read the data, to write the data and to modify any aspect of the HDF5 file (dataset, groups or attributes). The module also provides different error objects used to recognize errors when using the Wrapper object and raise exceptions.</p>
<p>The Wrapper object is initialized by running the following command:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wrp</span> <span class="o">=</span> <span class="n">Wrapper</span><span class="p">()</span>
</pre></div>
</div>
<p>This will create a new Wrapper object with no attributes or data, and with the following structure:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>file.h5
<span class="w"> </span>└──<span class="w"> </span>Brillouin<span class="w"> </span><span class="o">(</span>group<span class="o">)</span>
</pre></div>
</div>
<p>By default, the attributes of the “Brillouin” group are the following:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>file.h5
└──<span class="w"> </span>Brillouin<span class="w"> </span><span class="o">(</span>group<span class="o">)</span>
<span class="w">    </span>├──<span class="w"> </span>Brillouin_type<span class="w"> </span>-&gt;<span class="w"> </span><span class="s2">&quot;Root&quot;</span>
<span class="w">    </span>└──<span class="w"> </span>HDF5_BLS_version<span class="w"> </span>-&gt;<span class="w"> </span><span class="s2">&quot;0.1&quot;</span><span class="w"> </span><span class="c1"># The version of the HDF5_BLS package</span>
</pre></div>
</div>
<p>As long as no filepaths are given to the Wrapper object, the file is stored in a temporary folder (the temporary folder of the operating system). Note that this temporary file is deleted either when the Wrapper object is destroyed or when the file is stored elsewhere. It is therefore good practice to specify a non-temporary filepath to the file when creating a new Wrapper object, with the “filepath” parameter:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wrp</span> <span class="o">=</span> <span class="n">Wrapper</span><span class="p">(</span><span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;path/to/file.h5&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This will create a new Wrapper object with no attributes or data, and with the following structure:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>path/to/file.h5
└──<span class="w"> </span>Brillouin<span class="w"> </span><span class="o">(</span>group<span class="o">)</span>
</pre></div>
</div>
<p>Note that this works both for new files, and for files that already exist, in the latter case, the wrapper object applies to the file located at “path/to/file.h5”.</p>
</section>
<section id="adding-data-to-the-hdf5-file-from-script">
<h2>Adding data to the HDF5 file (from script)<a class="headerlink" href="#adding-data-to-the-hdf5-file-from-script" title="Link to this heading"></a></h2>
<p>The addition of any type of data or attribute to the HDF5 file has been centralized in the <em>Wrapper.add_ dictionary</em> method. This method is safe but complex and not user-friendly. Methods derived from this method are meant to simplify the process of adding data to the HDF5 file, specific to each type of data.</p>
<p>To add a single dataset to a group, we first need to specify the type of dataset we want to add, which are the following:</p>
<ul class="simple">
<li><p>“Abscissa_…”: An abscissa array for the measures where the dimensions on which the dataset applies are given after the underscore.</p></li>
<li><p>“Amplitude”: The dataset contains the values of the fitted amplitudes.</p></li>
<li><p>“Amplitude_err”: The dataset contains the error of the fitted amplitudes.</p></li>
<li><p>“BLT”: The dataset contains the values of the fitted amplitudes.</p></li>
<li><p>“BLT_err”: The dataset contains the error of the fitted amplitudes.</p></li>
<li><p>“Frequency”: A frequency array associated to the power spectral density</p></li>
<li><p>“Linewidth”: The dataset contains the values of the fitted linewidths.</p></li>
<li><p>“Linewidth_err”: The dataset contains the error of the fitted linewidths.</p></li>
<li><p>“PSD”: A power spectral density array</p></li>
<li><p>“Raw_data”: The dataset containing the raw data obtained after a BLS experiment.</p></li>
<li><p>“Shift”: The dataset contains the values of the fitted frequency shifts.</p></li>
<li><p>“Shift_err”: The dataset contains the error of the fitted frequency shifts.</p></li>
<li><p>“Other”: The dataset contains other data that will not be used by the library.</p></li>
</ul>
<p>From there, the following functions are available to add the dataset to the HDF5 file:</p>
<ul class="simple">
<li><p>add_raw_data: To add raw data to a group</p></li>
<li><p>add_PSD: To add a PSD to a group</p></li>
<li><p>add_frequency: To add a frequency axis to a group</p></li>
<li><p>add_abscissa: To add an abscissa to a group</p></li>
<li><p>add_treated_data: To add a shift, linewidth and their respective errors to a dedicated “Treatment” group</p></li>
<li><p>add_other: To add a shift, linewidth and their respective errors to a dedicated “Treatment” group</p></li>
</ul>
<section id="general-approach-to-adding-data-to-the-hdf5-file">
<h3>General approach to adding data to the HDF5 file<a class="headerlink" href="#general-approach-to-adding-data-to-the-hdf5-file" title="Link to this heading"></a></h3>
<p>Adding a dataset to the file always come with three other pieces of information:</p>
<ul class="simple">
<li><p>Where to add the dataset in the file</p></li>
<li><p>What to call the added dataset</p></li>
<li><p>What is the type of the dataset we want to add</p></li>
</ul>
<p>To add a dataset to the file, we’ll therefore call type-specific functions with the data to add, the place where to add it and the name to give the dataset as arguments, following a code of line resembling:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wrp</span><span class="o">.</span><span class="n">add_raw_data</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
                 <span class="n">parent_group</span> <span class="o">=</span> <span class="s2">&quot;Brillouin/Water spectrum&quot;</span><span class="p">,</span>
                 <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Measure of the year&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This approach is the one used for
* <em>add_raw_data</em>
* <em>add_PSD</em>
* <em>add_frequency</em>
* <em>add_other</em></p>
<p><strong>Example</strong>
Let’s consider the following example: we have just initialized a wrapper object and want to add a spectrum obtained from our spectrometer. We have already converted this spectrum to a numpy array, and named it <em>data</em>. Now we want to add this data in a group called “Water spectrum” in the root group of the HDF5 file and call this raw data “Measure of the year”. Then we will write:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wrp</span><span class="o">.</span><span class="n">add_raw_data</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
                 <span class="n">parent_group</span> <span class="o">=</span> <span class="s2">&quot;Brillouin/Water spectrum&quot;</span><span class="p">,</span>
                 <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Measure of the year&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now let’s say that we have analyzed this spectrum and obtained a PSD (stored in the variable “psd”) and frequency array (stored in the variable “freq”). We want to add these two arrays in the same group, and call them “PSD” and “Frequency” respectively. We will write:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wrp</span><span class="o">.</span><span class="n">add_PSD</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">psd</span><span class="p">,</span>
            <span class="n">parent_group</span> <span class="o">=</span> <span class="s2">&quot;Brillouin/Water spectrum&quot;</span><span class="p">,</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;PSD&quot;</span><span class="p">)</span>
<span class="n">wrp</span><span class="o">.</span><span class="n">add_frequency</span><span class="p">(</span><span class="n">freq</span><span class="p">,</span>
                  <span class="n">parent_group</span> <span class="o">=</span> <span class="s2">&quot;Brillouin/Water spectrum&quot;</span><span class="p">,</span>
                  <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Frequency&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="exception-1-adding-treated-data">
<h3>Exception 1: Adding treated data<a class="headerlink" href="#exception-1-adding-treated-data" title="Link to this heading"></a></h3>
<p>Adding treated data differs slightly from adding individual datasets as we’ll usually collect a number of different results to store. Therefore, instead of using different functions to store a shift or linewidth array, we have chosen to use a single function to add all the results of treatment, and create the group dedicated to storing the treatment results. As such, the function will have the following attributes:</p>
<ul class="simple">
<li><p>parent_group: The parent group where to store the data in the HDF5 file</p></li>
<li><p>name_group: The name of the group that will contain the treatment results</p></li>
<li><p>amplitude (optional): The amplitude array to add</p></li>
<li><p>amplitude_err (optional): The error of the amplitude array</p></li>
<li><p>blt (optional): The Loss Tangent array to add</p></li>
<li><p>blt_err (optional): The error of the Loss Tangent array</p></li>
<li><p>linewidth (optional): The linewidth array to add</p></li>
<li><p>linewidth_err (optional): The error of the linewidth array</p></li>
<li><p>shift(optional): The shift array to add</p></li>
<li><p>shift_err (optional): The error of the shift array</p></li>
</ul>
<p><strong>Example</strong></p>
<p>Let’s consider the following example: we have treated our data and have obtained a shift array (shift), a linewidth array (linewidth) and their errors (shift_err and linewidth_err). We want to add these arrays in the same group as the PSD, that is the group “Test”. The treated data are stored in a separate group nested in the “Test” group by the choices made while building the structure of the file. This is so the name of the treatment group can be chosen freely. Let’s say that in this case, we have performed a non-negative matrix factorization (NnMF) on the data, and extracted the shift values closest to 5GHz. We will therefore call this treatment “NnMF - 5GHz”. We will write:</p>
</section>
<section id="exception-2-adding-an-abscissa">
<h3>Exception 2: Adding an abscissa<a class="headerlink" href="#exception-2-adding-an-abscissa" title="Link to this heading"></a></h3>
<p>Adding abscissa also differs from the general case as we might want to add an abscissa array that is multi-dimensional and be able to know which dimensions of the PSD the abscissa correspomnds to. The <em>add_abscissa</em> method therefore has the following attributes:</p>
<ul class="simple">
<li><p>parent_group: The parent group where to store the data in the HDF5 file</p></li>
<li><p>name: The name of the abscissa to add</p></li>
<li><p>unit: The unit of the axis</p></li>
<li><p>dim_start: The first dimension of the abscissa array, by default 0</p></li>
<li><p>dim_end: The last dimension of the abscissa array, by default the last number of dimension of the array</p></li>
</ul>
<p><strong>Example</strong>
Let’s consider the following example: we have just initialized a wrapper object and want to add an abscissa axis corresponding to our measures that have been stored in the group “Brillouin/Temp”. Say that this abscissa axis corresponds to temperature values, from 35 to 40 degrees and that there are 10 points in the axis. We will therefore call this abscissa axis “Temperature”. We will write:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wrp</span><span class="o">.</span><span class="n">add_abscissa</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">35</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                <span class="n">parent_group</span> <span class="o">=</span> <span class="s2">&quot;Brillouin/Temp&quot;</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Temperature&quot;</span><span class="p">,</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span>
                <span class="n">dim_start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">dim_end</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>If you now want to use custom values for this axis, you can also specify them directly in the function call:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wrp</span><span class="o">.</span><span class="n">add_abscissa</span><span class="p">(</span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">,</span>
                <span class="n">parent_group</span> <span class="o">=</span> <span class="s2">&quot;Brillouin/Temp&quot;</span><span class="p">,</span>
                <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Temperature&quot;</span><span class="p">,</span>
                <span class="n">unit</span> <span class="o">=</span> <span class="s2">&quot;C&quot;</span><span class="p">,</span>
                <span class="n">dim_start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span>
                <span class="n">dim_end</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="importing-data-from-external-files">
<h2>Importing data from external files<a class="headerlink" href="#importing-data-from-external-files" title="Link to this heading"></a></h2>
<p>Importing datasets to the HDF5 file from independent data files, through the HDF5_BLS package, is always done following to successive steps:</p>
<ol class="arabic simple">
<li><p>Extracting the data and the metadata that can be extracted from the data files. This can be done using the <em>load_data</em> module.</p></li>
<li><p>Adding the data and metadata to the HDF5 file. This is done using the <em>Wrapper.add_dictionary</em> method.</p></li>
</ol>
<p>To make the process more user friendly, we have developed a set of derived methods that are specific to each type of data that is to be added (Raw data, PSD, Frequency, Abscissa or treated data).</p>
<p>In this section, we will present these methods. We encourage interested readers to refer to the chapter dedicated to the load_data module for more information on the extraction of the data and the metadata.</p>
<section id="general-approach-for-importing-data">
<h3>General approach for importing data<a class="headerlink" href="#general-approach-for-importing-data" title="Link to this heading"></a></h3>
<p>Much like adding data from a script, we can import data from external files by using type-specific functions. These functions are:</p>
<ul class="simple">
<li><p><em>Wrapper.import_abscissa</em>: To import an abscissa array.</p></li>
<li><p><em>Wrapper.import_frequency</em>: To import a frequency array.</p></li>
<li><p><em>Wrapper.import_PSD</em>: To import a PSD array.</p></li>
<li><p><em>Wrapper.import_raw_data</em>: To import raw data.</p></li>
<li><p><em>Wrapper.import_treated_data</em>: To import the data arrays resulting from a treatment.</p></li>
</ul>
<p>These function work a bit differently from the ones used to add data, as we might need parameters to extract the data from the file. Therefore, these functions have the following attributes:</p>
<ul class="simple">
<li><p>filepath: The filepath to the file to import the data from.</p></li>
<li><p>parent_group: The parent group where to store the data in the HDF5 file.</p></li>
<li><p>name: The name of the dataset to add.</p></li>
<li><p>creator: An identifier of the creator of the file. This is used to differentiate different structures of files using the same format (for example .dat files).</p></li>
<li><p>parameters: A dictionary containing the parameters that are needed to extract the data from the file. This is used to either access the data if it is somehow encoded or to interpret the data if a routine pipeline is used to obtain for example a PSD from a time-domain dataset</p></li>
<li><p>reshape: The new shape of the array, by default None means that the shape is not changed</p></li>
<li><p>overwrite: A parameter to indicate whether the dataset should be overwritten if it already exists, by default False - attributes are not overwritten.</p></li>
<li><p><em>all the attributes corresponding to the type of data (abscissa, frequency, PSD, raw data, treated data)</em></p></li>
</ul>
<p><strong>Example</strong>
Let’s consider the following example: we have just initialized a wrapper object and want to import an abscissa axis corresponding to our measures that have been stored in a .npy file (for example if a Python routine has been used to impose conditions for the measure). In that case, the array can be interpreted without any parameters nor specification.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wrp</span><span class="o">.</span><span class="n">import_abscissa</span><span class="p">(</span><span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;path/to/file.npy&quot;</span><span class="p">,</span> <span class="n">parent_group</span> <span class="o">=</span> <span class="s2">&quot;Brillouin/Measure&quot;</span><span class="p">,</span> <span class="n">creator</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">parameters</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">name</span> <span class="o">=</span> <span class="s2">&quot;Time&quot;</span><span class="p">,</span> <span class="n">unit</span> <span class="o">=</span> <span class="s2">&quot;s&quot;</span><span class="p">,</span> <span class="n">dim_start</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="n">dim_end</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">reshape</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="n">overwrite</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="adding-and-merging-hdf5-files">
<h2>Adding and merging HDF5 files<a class="headerlink" href="#adding-and-merging-hdf5-files" title="Link to this heading"></a></h2>
<p>Creating a new HDF5 file based on two existing ones can be done one of two ways depending on the desired end result.</p>
<ul>
<li><dl>
<dt>The <em>__add__</em> dunder metthod. If we want to combine two HDF5 files into a single one “plainly”, for example if we are generating a new HDF5 after each measure, with this structure:</dt><dd><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>20250214_HVEC_03.h5
+--<span class="w"> </span>Brillouin<span class="w"> </span><span class="o">(</span>group<span class="o">)</span>
<span class="p">|</span><span class="w">   </span>+--<span class="w"> </span>20250214_HVEC_02
<span class="p">|</span><span class="w">   </span><span class="p">|</span><span class="w">   </span>+--<span class="w"> </span>Measure<span class="w"> </span><span class="o">(</span>dataset<span class="o">)</span>
</pre></div>
</div>
<p>and we already have a HDF5 file containing the data of the previous experiment:
.. code-block:: bash</p>
<blockquote>
<div><p>20250214_HVEC.h5
+– Brillouin (group)
|   +– 20250214_HVEC_01
|   |   +– Measure (dataset)
|   +– 20250214_HVEC_02
|   |   +– Measure (dataset)</p>
</div></blockquote>
<p>We can simply add the first HDF5 file to the second one with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wrp1</span> <span class="o">=</span> <span class="n">Wrapper</span><span class="p">(</span><span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;.../20250214_HVEC.h5&quot;</span><span class="p">)</span>
<span class="n">wrp2</span> <span class="o">=</span> <span class="n">Wrapper</span><span class="p">(</span><span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;.../20250214_HVEC_02.h5&quot;</span><span class="p">)</span>
<span class="n">wrp</span> <span class="o">=</span> <span class="n">wrp1</span> <span class="o">+</span> <span class="n">wrp2</span>
</pre></div>
</div>
<p>This will create a new HDF5 file with the following structure:
.. code-block:: bash</p>
<blockquote>
<div><p>20250214_HVEC.h5
+– Brillouin (group)
|   +– 20250214_HVEC_01
|   |   +– Measure (dataset)
|   +– 20250214_HVEC_02
|   |   +– Measure (dataset)
|   +– 20250214_HVEC_03
|   |   +– Measure (dataset)</p>
</div></blockquote>
<p><strong>WARNING:</strong> The new file is a temporary file, it is therefore important to save it after the addition of the two files with:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wrp</span><span class="o">.</span><span class="n">save_as_hdf5</span><span class="p">(</span><span class="n">filepath</span> <span class="o">=</span> <span class="n">wrp</span><span class="o">.</span><span class="n">filepath</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that from there, wrp1 and wrp will be the same as the wrapper does not store any data in memory but just acts as an access facilitator to the file.</p>
</dd>
</dl>
</li>
<li><dl>
<dt>The <em>add_hdf5</em> method. If we want to import the HDF5 as a new group, for example if we have this HDF5 file containing the data of a cell study:</dt><dd><div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>Neuronal_cell_study.h5
+--<span class="w"> </span>Brillouin<span class="w"> </span><span class="o">(</span>group<span class="o">)</span>
<span class="p">|</span><span class="w">   </span>+--<span class="w"> </span>Neuronal<span class="w"> </span><span class="o">(</span>group<span class="o">)</span>
<span class="p">|</span><span class="w">   </span><span class="p">|</span><span class="w">   </span>+--<span class="w"> </span>GT<span class="w"> </span><span class="m">1</span>-7<span class="w"> </span><span class="o">(</span>group<span class="o">)</span>
<span class="p">|</span><span class="w">   </span><span class="p">|</span><span class="w">   </span><span class="p">|</span><span class="w">   </span>+--<span class="w"> </span>...
<span class="p">|</span><span class="w">   </span><span class="p">|</span><span class="w">   </span>+--<span class="w"> </span>L-fibroblast<span class="w"> </span><span class="o">(</span>group<span class="o">)</span>
<span class="p">|</span><span class="w">   </span><span class="p">|</span><span class="w">   </span><span class="p">|</span><span class="w">   </span>+--<span class="w"> </span>...
<span class="p">|</span><span class="w">   </span>+--<span class="w"> </span>Skeletal<span class="w"> </span><span class="o">(</span>group<span class="o">)</span>
<span class="p">|</span><span class="w">   </span><span class="p">|</span><span class="w">   </span>+--<span class="w"> </span>...
</pre></div>
</div>
<p>And we want to import data done on another neuronal cell line, say “MOV”, that have been stored in the following HDF5 file:
.. code-block:: bash</p>
<blockquote>
<div><p>MOV.h5
+– Brillouin (group)
|   +– MOV (group)
|   |   +– …</p>
</div></blockquote>
<p>We can simply add the second HDF5 file to the first one by specifying the path to the second file in the <em>Wrapper.add_hdf5</em> method:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">wrp1</span> <span class="o">=</span> <span class="n">Wrapper</span><span class="p">(</span><span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;.../Neuronal_cell_study.h5&quot;</span><span class="p">)</span>
<span class="n">wrp1</span><span class="o">.</span><span class="n">add_hdf5</span><span class="p">(</span><span class="n">filepath</span> <span class="o">=</span> <span class="s2">&quot;.../MOV.h5&quot;</span><span class="p">,</span> <span class="n">parent_group</span> <span class="o">=</span> <span class="s2">&quot;Brillouin/Neuronal&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This will create a new HDF5 file with the following structure:
.. code-block:: bash</p>
<blockquote>
<div><p>Neuronal_cell_study.h5
+– Brillouin (group)
|   +– Neuronal (group)
|   |   +– GT 1-7 (group)
|   |   |   +– …
|   |   +– L-fibroblast (group)
|   |   |   +– …
|   |   +– MOV (group)
|   |   |   +– …
|   +– Skeletal (group)
|   |   +– …</p>
</div></blockquote>
</dd>
</dl>
</li>
</ul>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="file_format.html" class="btn btn-neutral float-left" title="The file format" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../_autosummary/HDF5_BLS.wrapper.html" class="btn btn-neutral float-right" title="HDF5_BLS.wrapper" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2025, Pierre Bouvet.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>